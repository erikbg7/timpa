generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("DATABASE_URL")
    directUrl = env("DIRECT_URL")
}

model Customer {
    id         BigInt   @id @default(autoincrement())
    created_at DateTime @default(now()) @db.Timestamptz(6)
    email      String   @unique

    plan Plan @default(FREE)

    workspaces Workspace[]
}

model Workspace {
    id         BigInt   @id @default(autoincrement())
    created_at DateTime @default(now()) @db.Timestamptz(6)

    name        String
    description String?

    customer   Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
    customerId BigInt

    FlowSession FlowSession[]
}

model FlowSession {
    id        BigInt   @id @default(autoincrement())
    createdAt DateTime @default(now()) @db.Timestamptz(6)

    workspace   Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)
    workspaceId BigInt

    events Event[]
}

model Event {
    id        BigInt   @id @default(autoincrement())
    createdAt DateTime @default(now()) @db.Timestamptz(6)

    eventType   EventType
    description String?

    flowSession   FlowSession @relation(fields: [flowSessionId], references: [id], onDelete: Cascade)
    flowSessionId BigInt
}

enum EventType {
    START
    BREAK
    INTERRUPTION
    LONG_BREAK
    END
}

enum Plan {
    FREE
    STANDARD
    PRO
}
